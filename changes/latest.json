{
  "operations": [
    {
      "file": "src/tutorial.js",
      "op": "insert_after",
      "anchor": "connectDrawGridToPlayer(panel);",
      "id": "TUTORIAL_FREEZE_BOARD_VIEWPORT",
      "text": "\n/* << GPT:TUTORIAL_FREEZE_BOARD_VIEWPORT START >> */\n// Reset and freeze the main board viewport while the tutorial is active.\n// This prevents saved/other-view zoom from leaking in.\ntry {\n  const board = document.getElementById('board');\n  if (board) {\n    // Reset any transform so header/goals are on-screen\n    board.style.transformOrigin = '0 0';\n    board.style.transform = 'translate(0px, 0px) scale(1)';\n    // Block board-viewport interactions (wheel/pan/touch) while in tutorial\n    const stop = (e) => { e.stopImmediatePropagation(); e.preventDefault(); };\n    board._tutBlockers = board._tutBlockers || [];\n    const types = [\n      ['wheel',      { passive: false, capture: true }],\n      ['mousedown',  { passive: false, capture: true }],\n      ['mousemove',  { passive: false, capture: true }],\n      ['mouseup',    { passive: false, capture: true }],\n      ['touchstart', { passive: false, capture: true }],\n      ['touchmove',  { passive: false, capture: true }],\n      ['touchend',   { passive: false, capture: true }]\n    ];\n    for (const [type, opts] of types) {\n      board.addEventListener(type, stop, opts);\n      board._tutBlockers.push([type, stop, opts]);\n    }\n  }\n} catch (e) { /* no-op */ }\n/* << GPT:TUTORIAL_FREEZE_BOARD_VIEWPORT END >> */\n"
    },
    {
      "file": "src/tutorial.js",
      "op": "insert_after",
      "anchor": "panel.style.top = top + 'px';",
      "id": "TUTORIAL_RECENTER_FINAL",
      "text": "\n/* << GPT:TUTORIAL_RECENTER_FINAL START >> */\n// Re-center after layout & any transform resets settle (2x rAF).\ntry {\n  requestAnimationFrame(() => requestAnimationFrame(() => {\n    const r = panel.getBoundingClientRect();\n    const sx = window.scrollX || document.documentElement.scrollLeft || 0;\n    const sy = window.scrollY || document.documentElement.scrollTop || 0;\n    const cx = r.left + r.width / 2 + sx;\n    const cy = r.top  + r.height / 2 + sy;\n    window.scrollTo({\n      left: Math.max(0, Math.round(cx - window.innerWidth  / 2)),\n      top:  Math.max(0, Math.round(cy - window.innerHeight / 2)),\n      behavior: 'auto'\n    });\n  }));\n} catch (e) { /* no-op */ }\n/* << GPT:TUTORIAL_RECENTER_FINAL END >> */\n"
    }
  ]
}
{
  "operations": [
    {
      "file": "src/tutorial.js",
      "op": "replace_between",
      "start": "if\\s*\\(targetVisible\\)\\s*\\{",
      "end": "\\n\\s*if\\s*\\(helpActivatedForTask\\)\\s*\\{",
      "text": "if (targetVisible) {\n  const taskEl = goalPanel?.querySelector('.goal-task.is-active');\n  if (taskEl) startParticleStream(taskEl, targetEl);\n\n  if (isPlayTask) {\n    const playButtonContainer = targetEl; // wrapper element holding .c-btn-outer/.c-btn-glow/.c-btn-core\n\n    // Prepare hidden state to avoid initial flash\n    playButtonContainer.classList.add('tutorial-play-hidden');\n    playButtonContainer.style.transformOrigin = '50% 50%';\n    playButtonContainer.style.willChange = 'transform, opacity';\n    playButtonContainer.style.transform = 'scale(0)';\n    playButtonContainer.style.opacity = '1';\n\n    // Reveal and animate on next frame\n    requestAnimationFrame(() => {\n      if (!playButtonContainer.isConnected) return;\n\n      // Reveal with guards set and force layout\n      playButtonContainer.classList.remove('tutorial-play-hidden');\n      void playButtonContainer.offsetWidth;\n\n      // Clean previous animations, if any\n      if (playButtonContainer._tutorialAnim && typeof playButtonContainer._tutorialAnim.cancel === 'function') {\n        playButtonContainer._tutorialAnim.cancel();\n      }\n\n      // Animate the INNER visual so centering translate stays intact\n      const playButtonVisual = playButtonContainer.querySelector('.c-btn-core') || playButtonContainer;\n\n      // Ensure starting state on the visual as well\n      playButtonVisual.style.willChange = 'transform, opacity';\n      playButtonVisual.style.transform = 'scale(0)';\n      playButtonVisual.style.opacity = '1';\n\n      // Flash accent\n      playButtonVisual.classList.add('tutorial-flash');\n      setTimeout(() => playButtonVisual.classList.remove('tutorial-flash'), 320);\n\n      if (!playButtonVisual.animate) {\n        // Fallback path without WAAPI\n        playButtonVisual.style.removeProperty('transform');\n        playButtonVisual.style.removeProperty('will-change');\n        playButtonVisual.style.removeProperty('opacity');\n        playButtonVisual.classList.add('tutorial-pulse-target');\n        playButtonContainer.style.removeProperty('transform');\n        playButtonContainer.style.removeProperty('will-change');\n        playButtonContainer.style.removeProperty('opacity');\n        return;\n      }\n\n      playButtonVisual._tutorialAnim = playButtonVisual.animate(\n        [\n          { transform: 'scale(0)',    opacity: 1, offset: 0.00 },\n          { transform: 'scale(2.0)',  opacity: 1, offset: 0.60 },\n          { transform: 'scale(0.92)', opacity: 1, offset: 0.85 },\n          { transform: 'scale(1.0)',  opacity: 1, offset: 1.00 }\n        ],\n        {\n          duration: 1200,\n          easing: 'cubic-bezier(0.22, 1, 0.36, 1)',\n          fill: 'both',\n          composite: 'replace'\n        }\n      );\n\n      const finish = () => {\n        playButtonVisual.classList.add('tutorial-pulse-target');\n        playButtonVisual.style.removeProperty('transform');\n        playButtonVisual.style.removeProperty('will-change');\n        playButtonVisual.style.removeProperty('opacity');\n        playButtonContainer.style.removeProperty('transform');\n        playButtonContainer.style.removeProperty('will-change');\n        playButtonContainer.style.removeProperty('opacity');\n        playButtonVisual._tutorialAnim = null;\n      };\n      if (playButtonVisual._tutorialAnim && typeof playButtonVisual._tutorialAnim === 'object') {\n        playButtonVisual._tutorialAnim.onfinish = finish;\n        playButtonVisual._tutorialAnim.oncancel = finish;\n      }\n    });\n  } else {\n    targetEl.classList.add('tutorial-pulse-target');\n  }\n} else {\n  stopParticleStream();\n}\n\n"
    }
  ]
}
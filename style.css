/* style.css â€” clean base styles (<=300 lines) */
:root{
  --bg:#0f141b;
  --panel:#121a24;
  --surface:#0d141d;
  --border:#1c2430;
  --text:#e6e8ef;
  --muted:#9aa4b2;
  --accent:#5fb3ff;
}

*{ box-sizing:border-box; }
html,body{ height:100%; margin:0; background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,'Noto Sans',sans-serif; }

/* Topbar */
.topbar{ position:sticky; top:0; z-index:1000; display:flex; gap:10px; align-items:center; padding:10px 12px; background:linear-gradient(180deg, rgba(18,26,36,0.95), rgba(18,26,36,0.85)); border-bottom:1px solid var(--border); backdrop-filter: blur(6px); }
.topbar button{ padding:6px 10px; border-radius:8px; border:1px solid var(--border); background:var(--surface); color:var(--text); }
.topbar input[type="number"]{ width:76px; padding:6px 8px; border-radius:8px; border:1px solid var(--border); background:var(--surface); color:var(--text); }

/* Board defaults (ui-fixes.css will enhance to grid) */
#board{ padding:16px; display:block; }

/* Panels */
.toy-panel{ position:relative; display:flex; flex-direction:column; background:var(--panel); border:1px solid var(--border); border-radius:12px; box-shadow: 0 8px 24px rgba(0,0,0,0.35); min-height:200px; overflow:hidden; }
.toy-header{ position:relative; z-index:200;  display:flex; align-items:center; justify-content:space-between; gap:10px; padding:8px 10px; background:linear-gradient(180deg, rgba(13,20,29,0.9), rgba(13,20,29,0.75)); border-bottom:1px solid var(--border); }
.toy-title{ font-weight:700; letter-spacing:0.02em; color:var(--text); }
.toy-controls-right{ display:flex; gap:8px; align-items:center; }

.toy-body{ position:relative; padding:0; overflow:hidden; }
.toy-footer{ position:relative; padding:10px; }

/* Volume card */
.toy-volwrap{ display:flex; gap:10px; align-items:center; background:rgba(13,20,29,0.85); border:1px solid var(--border); border-radius:10px; padding:8px 10px; }
.toy-volwrap input[type="range"]{ width:100%; flex:1; }
.toy-volwrap button{ padding:6px 10px; border-radius:8px; border:1px solid var(--border); background:var(--surface); color:var(--text); }

/* Pretty header buttons */
.toy-btn{ appearance:none; cursor:pointer; user-select:none; padding:6px 12px; border-radius:10px; border:1px solid var(--border); background:var(--surface); color:var(--text); box-shadow: inset 0 1px 0 rgba(255,255,255,0.06), 0 2px 6px rgba(0,0,0,0.35); transition: transform .07s ease, background .15s ease, border-color .15s ease; }
.toy-btn:hover{ background:#111a26; border-color:#243244; }
.toy-btn:active{ transform: translateY(1px) scale(0.99); }

/* Keep headers above canvases */
.toy-panel .toy-header{ position:relative; z-index:200;  z-index:3; }
.toy-panel .toy-body{ z-index:1; }
.toy-panel .toy-footer{ z-index:2; }

/* Organise button */
#organise-toys-btn{ position:fixed; top:10px; right:10px; z-index:10001; padding:8px 12px; border-radius:10px; border:1px solid var(--border); background:var(--surface); color:var(--text); }

#board{ position:absolute; inset:0; }

.topbar{ position:fixed; top:0; left:0; right:0; height:48px; }
#board{ position:absolute; top:48px; left:0; right:0; bottom:0; }
html,body{ overflow:hidden; }
.toy-body{ position:relative; width:100%; }

.toy-footer{ position:relative; }


/* Footer below body with spacing */
.toy-footer{ margin-top:12px; }
/* Range slider styling for visibility */
.toy-volwrap input[type="range"]{ -webkit-appearance: none; height:6px; border-radius:6px; background:#1e2a38; outline:none; }
.toy-volwrap input[type="range"]::-webkit-slider-thumb{ -webkit-appearance: none; width:18px; height:18px; border-radius:50%; background:#c56a1a; border:2px solid #0d141d; box-shadow: 0 2px 6px rgba(0,0,0,.45); margin-top:-6px; }
.toy-volwrap input[type="range"]::-moz-range-thumb{ width:18px; height:18px; border-radius:50%; background:#c56a1a; border:2px solid #0d141d; box-shadow: 0 2px 6px rgba(0,0,0,.45); }

.toy-body{ position:relative; z-index:1; }

.toy-footer{ position:relative; z-index:2; }

.toy-panel[data-toy="loopgrid"] .toy-body{ aspect-ratio:1 / 1; }

.toy-footer{ position:relative; z-index:2; margin-top:12px; }


/* Force visible slider UI */
.toy-volwrap input[type="range"]{
  appearance: auto;
  -webkit-appearance: slider-horizontal;
  height: 18px;
}
.toy-volwrap{ display:flex; gap:10px; align-items:center; background:rgba(13,20,29,0.85); border:1px solid #1c2430; border-radius:8px; padding:8px 10px; }
.toy-volwrap .toy-btn{ min-width:40px; }


/* --- Slider + footer normalization (clean override) --- */
.toy-panel{ position:relative; display:flex; flex-direction:column; }
.toy-body{ position:relative; width:100%; z-index:1; }
.toy-footer{ position:relative; z-index:2; margin-top:12px; }

.toy-volwrap{ display:flex; gap:10px; align-items:center; background:rgba(13,20,29,0.85); border:1px solid #1c2430; border-radius:8px; padding:8px 10px; }
.toy-volwrap .toy-btn{ min-width:44px; }

.toy-volwrap input[type="range"]{
  appearance:auto; -webkit-appearance: slider-horizontal;
  width:100%; height:18px; outline: none;
}
.toy-volwrap input[type="range"]::-webkit-slider-thumb{ -webkit-appearance: none; width:16px; height:16px; border-radius:2px; background:#f4932f; border:1px solid #0d141d; margin-top:-6px; }
.toy-volwrap input[type="range"]::-moz-range-thumb{ width:16px; height:16px; border-radius:2px; background:#f4932f; border:1px solid #0d141d; }

/* loopgrid square body */
.toy-panel[data-toy="loopgrid"] .toy-body{ aspect-ratio: 1 / 1; }


/* Topbar */
.app-topbar{ position:fixed; top:0; left:0; right:0; height:48px; display:flex; align-items:center; justify-content:space-between; padding:0 12px; background:#0d141d; border-bottom:1px solid #1c2430; z-index:10; }
.app-topbar .brand{ color:#cbd5e1; font-weight:600; }
.app-topbar .toy-btn{ margin-left:6px; }

/* Board area sits below topbar */
#board{ position:absolute; top:48px; left:0; right:0; bottom:0; }

/* Draggable header cursor */
.toy-header{ position:relative; z-index:200;  cursor:move; user-select:none; }

/* Panels absolute stacking default (board.js persists positions) */
.toy-panel{ position:absolute; }

/* Normalize font sizes back to readable */
:root{ font-size: 16px; }
.toy-header, .toy-footer, .toy-btn{ font-size: 14px; }


/* Panel default sizing to prevent full-width stacking */
.toy-panel{ width: var(--panel-w, 380px); }
.toy-panel .toy-body{ min-height: var(--panel-h, 320px); }
/* Loopgrid uses square body; width controls size */
.toy-panel[data-toy="loopgrid"]{ --panel-w: 380px; }
.toy-panel[data-toy="loopgrid"] .toy-body{ aspect-ratio: 1 / 1; min-height: 0; }
/* Bouncer defaults */
.toy-panel[data-toy="bouncer"]{ --panel-w:  300px; }
/* Drawgrid defaults */
.toy-panel[data-toy="drawgrid"]{ --panel-w: 420px; }


/* Advanced overlay */
#adv-overlay{ position:fixed; inset:0; display:none; z-index:2000; }
#adv-overlay.open{ display:block; }
#adv-overlay .adv-backdrop{ position:absolute; inset:0; background:rgba(0,0,0,0.55); }
#adv-overlay .adv-host{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); max-width:90vw; max-height:90vh; display:flex; flex-direction:column; gap:10px; }
#adv-overlay .adv-controls{ display:flex; gap:10px; justify-content:center; }
#adv-overlay.open .adv-open{ width: var(--adv-w, min(90vw, 880px)) !important; }
#adv-overlay.open .adv-open .toy-body{ aspect-ratio:auto !important; height: var(--adv-h, min(70vh, 600px)) !important; }

.toy-panel[data-toy="bouncer"] .toy-body{ aspect-ratio: 1 / 1; min-height: 0; }

/* instrument select visibility */
.toy-instrument{ display:none; }
#zoom-overlay .toy-instrument, .toy-panel.toy-zoomed .toy-instrument{ display:inline-block; }

/* make topbar theme select obviously visible */
#theme-select{ display:none !important; /* hide legacy header select */  position:relative; z-index:10000;  padding:6px 10px; border:1px solid var(--border, #666); border-radius:6px; cursor:pointer;  appearance: auto !important; -webkit-appearance: menulist !important; background:#fff !important; color:#111 !important;  min-width:180px; padding:6px 8px; border:1px solid var(--border); background:var(--surface); color:var(--text); }

/* debug pulse when Advanced button is clicked */
@keyframes advPulse { 0%{box-shadow:0 0 0 0 rgba(255,200,80,.9)} 100%{box-shadow:0 0 0 12px rgba(255,200,80,0)} }
.toy-panel.adv-debug-pulse{ animation: advPulse .6s ease-out 1; }

/* theme select must be clickable */
#theme-select{ display:none !important; /* hide legacy header select */  position:relative; z-index:10000;  padding:6px 10px; border:1px solid var(--border, #666); border-radius:6px; cursor:pointer;  appearance: auto !important; -webkit-appearance: menulist !important; background:#fff !important; color:#111 !important;  pointer-events:auto; position:relative; z-index:2000; }

#topbar{ position:sticky; top:0; z-index:5000; }

#theme-switcher-wrap, #theme-switcher-wrap * { pointer-events:auto !important; }
